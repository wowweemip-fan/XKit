{"id":"lethe","script":"//* TITLE Hermes **//\n//* VERSION 1.2.3 **//\n//* DESCRIPTION Helps speed up your Tumblr experience **//\n//* DEVELOPER new-xkit **//\n//* FRAME false **//\n//* BETA true **//\n\n\n/** Export Lethe */\nXKit.extensions.lethe = new Lethe();\n\nfunction Lethe() {\n\tthis.TOP_CUTOFF = -500;\n\tthis.running = false;\n\tthis.scrollWaiting = false;\n\tthis.hiddenPosts = [];\n}\n\n/**\n * Run Lethe\n */\nLethe.prototype.run = function() {\n\tif (!XKit.interface.where().dashboard) {\n\t\treturn;\n\t}\n\tthis.running = true;\n\tthis.handleScroll = this.handleScroll.bind(this);\n\twindow.addEventListener('scroll', this.handleScroll, false);\n};\n\n/**\n * Handle a scroll event, throttling to once every 100ms\n */\nLethe.prototype.handleScroll = function() {\n\tif (this.scrollWaiting) {\n\t\treturn;\n\t}\n\tthis.scrollWaiting = true;\n\tsetTimeout(this.updatePosts.bind(this), 100);\n};\n\n/**\n * Update the list of tracked posts, removing ones that are above/outside the\n * viewport and adding ones that are inside or below the viewport.\n */\nLethe.prototype.updatePosts = function() {\n\tthis.scrollWaiting = false;\n\n\tvar postMedias = document.querySelectorAll('.post_media');\n\tvar i;\n\tfor (i = 0; i < postMedias.length; i++) {\n\t\tvar postMedia = postMedias[i];\n\t\tif (postMedia.querySelector('.playing')) {\n\t\t\tcontinue;\n\t\t}\n\t\tvar rect = postMedia.getBoundingClientRect();\n\n\t\tif (rect.bottom > this.TOP_CUTOFF) {\n      // Rect is fully on screen, we want to keep it\n\t\t\tbreak;\n\t\t}\n\t\tthis.hidePost(postMedia);\n\t}\n\n\tfor (i = this.hiddenPosts.length - 1; i > -1; i--) {\n\t\tvar hiddenMedia = this.hiddenPosts[i];\n\t\tif (hiddenMedia.absoluteBottom < window.scrollY + this.TOP_CUTOFF) {\n      // hiddenMedia is higher than the current viewport\n      // all other posts should also be higher\n\t\t\tbreak;\n\t\t}\n\t\tthis.showPost(hiddenMedia);\n\t}\n};\n\n/**\n * Hide a post, storing it for later\n * @param {DOMElement} post\n */\nLethe.prototype.hidePost = function(post) {\n\tvar rect = post.getBoundingClientRect();\n\tvar placeholder = document.createElement('div');\n\tplaceholder.classList.add('post_media_hidden');\n\tplaceholder.style.width = rect.width + 'px';\n\tplaceholder.style.height = rect.height + 'px';\n\n\tvar parentNode = post.parentNode;\n\tparentNode.replaceChild(placeholder, post);\n\n\tvar absoluteBottom = rect.bottom + window.scrollY;\n\n\tthis.hiddenPosts.push({\n\t\tabsoluteBottom: absoluteBottom,\n\t\thtml: post.outerHTML,\n\t\tplaceholder: placeholder\n\t});\n};\n\n/**\n * Show a post, removing it from hidden posts\n * @param {DOMElement} hiddenPost\n */\nLethe.prototype.showPost = function(hiddenPost) {\n  // Overly conservative removal logic\n\tthis.hiddenPosts = this.hiddenPosts.filter(function(post) {\n\t\treturn post !== hiddenPost;\n\t});\n\thiddenPost.placeholder.outerHTML = hiddenPost.html;\n};\n\n/**\n * Destroy Lethe\n */\nLethe.prototype.destroy = function() {\n\tif (!this.running) {\n\t\treturn;\n\t}\n\tthis.running = false;\n\twindow.removeEventListener('scroll', this.handleScroll, false);\n};\n","file":"found","server":"up","errors":false,"icon":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAVFBMVEU1RlxCUmZOXXFbaXtndIRodYV0f490gI+Ai5mBjJqNl6OOl6Saoq2ao66mrrenrrizucK0usLAxczAxszM0dbN0dfZ3ODa3eHm6Ovy8/Xz9PX///9tjhPfAAACYElEQVR4AdXVb5eqLBQF8H0gKkLGHP+AnO//PZ9FUuoTht7e3Pt70VozK3Zb8SD+IfL0TiISAjsozugRqbFC2bAdgMD+igLDHwIMcylCjJ8C0HCMuBE2dfwxACZwdFfIs1wIgGj5wf9IvLvw5wBdAVA9PzNOWJNjIUDwoGJOz8n4exV4oYELAaiZ72JukYqcKRWoXSmAPPNYxQhRB54NzxDyhZsoA3NqgUvLSQoRsWIhICXw7xkA6NIsegSC5Lxg8SL9eh+ladN/7MYcsDeERBJAzat0JTFx8Wsbj5HXqyf9BoBs4GS832JI7KBBY2H5Yx+9ihHG8az7iZ+UG0RLWCPH3F3x2EfPS82jx1ov8EaEeR6FbuY1l/dBMMiRaR7PqZLStp2uoOYVJ5FHjie/NznPsPv/HjaETdpxMnbV+SRiQA0q1U8UxY/m/XoVL2hsMmMVI0i3vKSg+SVIbKPwPNHoUrtFgC2vXxxbvhKvTWimTbDl9Yl+nQGYxL8wB2iUKD8/xNVJyhSwe/1ympJFQINdyHpO1jfREfaStcsESOyirjRtpO1DCkizhLL0Br3HjIhUbGKh0lAWzS+QrpoO8/4xC9h/DxXPxm6a4z6dJyP2aHnhAj0t7A9cg+dZPf22gD3wHEiejSSHxy+nKyPsYXg2cNScfpZHSVHDWzz2cbxFoyydra1WX1QgQwB8sUJBnatA2E9whkVBaTtG8W2FDgcYzjA4oOcMif3I8buBjiSE4wk7OtxxALW5BMIBJnx5FRBNJkHiCJWJqHCIMI7XgsFBQjfPl5XvrcKfUhJ/n/8A/NSgVpmYw+UAAAAASUVORK5CYII=\n","title":"Hermes","description":"Helps speed up your Tumblr experience","developer":"new-xkit","version":"1.2.3","frame":"false","beta":"true","slow":"false"}