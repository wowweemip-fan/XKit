{"id":"old_notifications","script":"//* TITLE Classic Notifications **//\n//* VERSION 0.7.3 **//\n//* DESCRIPTION Notifications where they were **//\n//* DETAILS This is a very experimental extension that brings back the notifications to your blog pages (ie: www.tumblr.com/blog/new-xkit-extension), just the way it was before Tumblr's Activity update. **//\n//* DEVELOPER New-XKit **//\n//* FRAME false **//\n//* BETA false **//\n\nXKit.extensions.old_notifications = new Object({\n\n\trunning: false,\n\tblacklisted: [],\n\n\tpreferences: {\n\t\t\"count\": {\n\t\t\ttext: \"Number of Notifications to display\",\n\t\t\tdefault: \"c10\",\n\t\t\tvalue: \"c10\",\n\t\t\ttype: \"combo\",\n\t\t\tvalues: [\n\t\t\t\t\"5 Notifications\", \"c5\",\n\t\t\t\t\"10 Notifications (default)\", \"c10\",\n\t\t\t\t\"20 Notifications\", \"c20\"\n\t\t\t],\n\t\t}\n\t},\n\n\trun: function() {\n\t\tthis.running = true;\n\n\t\tif (document.location.href.indexOf('/new/') !== -1) { return; }\n\n\t\tif (XKit.interface.where().channel) {\n\t\t\tXKit.extensions.old_notifications.fetch();\n\t\t\t$(document).on('click', '.notification.xkit-old-notifications', XKit.extensions.old_notifications.open_notification);\n\t\t}\n\n\t\tthis.max_notifications = parseInt(this.preferences.count.value.substring(1));\n\n\t},\n\n\tfetch_failed: function(err) {\n\n\t\tconsole.log(\"Can't fetch Activity page!\");\n\n\t},\n\n\topen_notification: function(e) {\n\n\t\tvar m_target = $(e.target);\n\n\t\tif ($(m_target).hasClass(\"xkit-reply-button\") === true) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar m_parent = $(m_target).parentsUntil(\".xkit-old-notifications\").parent();\n\t\twindow.open($(m_parent).attr('data-load-url'));\n\n\t},\n\n\talt_notification: false,\n\tmax_notifications: 9,\n\tnotification_count: 0,\n\n\trender_notification: function(obj) {\n\n\t\tvar $obj = $(obj);\n\n\t\tif (!$obj.hasClass(\"activity-notification\")) {\n\t\t\treturn \"\";\n\t\t}\n\n\n\t\tvar notification_url = $obj.find(\".activity-notification__glass\").attr('href');\n\n\t\tvar notification_username = $obj.attr('data-tumblelog-name') || $obj.find(\".activity\").find(\"a\").text();\n\t\tvar notification_user_url = $obj.find(\".activity\").find(\"a\").attr('href');\n\t\tvar notification_avatar = $obj.find(\".ui_avatar_link\").attr('data-avatar-url');\n\n\t\tnotification_avatar = notification_avatar.replace(\"_64.png\", \"_40.png\");\n\t\tnotification_avatar = notification_avatar.replace(\"_64.gif\", \"_40.gif\");\n\t\tnotification_avatar = notification_avatar.replace(\"_64.jpg\", \"_40.jpg\");\n\t\tnotification_avatar = notification_avatar.replace(\"_128.png\", \"_40.png\");\n\t\tnotification_avatar = notification_avatar.replace(\"_128.gif\", \"_40.gif\");\n\t\tnotification_avatar = notification_avatar.replace(\"_128.jpg\", \"_40.jpg\");\n\n\t\tvar summary = \"\";\n\t\tif ($obj.find(\".activity-notification__activity_main\").find(\".summary\").length > 0) {\n\t\t\tsummary = $obj.find(\".activity-notification__activity_main\").find(\".summary\").html();\n\t\t}\n\n\t\tvar response = \"\";\n\t\tif ($obj.find(\".activity-notification__activity_response\").length > 0) {\n\t\t\tresponse = $obj.find(\".activity-notification__activity_response\").html();\n\t\t}\n\n\t\tvar fake_original_url = notification_url;\n\t\tvar original_id = null;\n\t\ttry {\n\t\t\tvar peepr = JSON.parse($obj.find(\".ui_post_badge\").attr('data-peepr'));\n\t\t\toriginal_id = peepr.postId;\n\t\t\tfake_original_url = `http://${peepr.tumblelog}.tumblr.com/post/${original_id}`;\n\t\t} catch (e) {\n\t\t}\n\n\t\tif (original_id) {\n\t\t\tif (typeof XKit.extensions.old_notifications !== \"undefined\") {\n\n\t\t\t\tfor (var i = 0; i < XKit.extensions.old_notifications.blacklisted.length; i++) {\n\t\t\t\t\tif (XKit.extensions.old_notifications.blacklisted[i] === \"\" ||\n\t\t\t\t\t    typeof(XKit.extensions.old_notifications.blacklisted[i]) === \"undefined\") {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif (original_id === XKit.extensions.old_notifications.blacklisted[i]) {\n\t\t\t\t\t\t// console.log(\"[Old Notifications]Blocking notification because of post \" + XKit.extensions.old_notifications.blacklisted[i]);\n\t\t\t\t\t\treturn \"\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar notification_preview = $obj.find(\".ui_post_badge\").css(\"background-image\");\n\n\t\tif (notification_preview !== \"\" && typeof notification_preview !== \"undefined\") {\n\t\t\tnotification_preview = notification_preview.substring(4, notification_preview.length - 1);\n\t\t\tif (notification_preview.indexOf(\"\\\"\") !== -1) {\n\t\t\t\tnotification_preview = XKit.tools.replace_all(notification_preview, \"\\\"\", \"\");\n\t\t\t}\n\t\t}\n\n\t\tvar is_friend = $obj.hasClass(\"is_friend\");\n\t\tvar is_reblog = $obj.hasClass(\"is_reblog\") || $obj.hasClass(\"is_reblog_naked\");\n\t\tvar is_reply = $obj.hasClass(\"is_reply\");\n\t\tvar is_answer = $obj.hasClass(\"is_answer\");\n\t\tvar is_like = $obj.hasClass(\"is_like\");\n\t\tvar is_follow = $obj.hasClass(\"is_follower\");\n\t\tvar is_mention = $obj.hasClass(\"user_mention\") || $obj.hasClass(\"note_mention\");\n\n\t\tvar preview_frame_class = \"icon regular\";\n\t\tvar preview_image = notification_preview;\n\n\t\tvar is_post_photo = $obj.find(\".ui_post_badge\").hasClass(\"photo\");\n\t\tvar is_post_chat = $obj.find(\".ui_post_badge\").hasClass(\"conversation\");\n\t\tvar is_post_quote = $obj.find(\".ui_post_badge\").hasClass(\"quote\");\n\t\tvar is_post_link = $obj.find(\".ui_post_badge\").hasClass(\"link\");\n\t\tvar is_post_audio = $obj.find(\".ui_post_badge\").hasClass(\"audio\");\n\t\tvar is_post_video = $obj.find(\".ui_post_badge\").hasClass(\"video\");\n\n\t\tvar m_post_type_text = \"post\";\n\t\tif (is_post_photo) { m_post_type_text = \"photo\"; preview_frame_class = \"\"; }\n\t\tif (is_post_chat) { m_post_type_text = \"chat\"; preview_frame_class = \"icon chat\"; }\n\t\tif (is_post_quote) { m_post_type_text = \"quote\"; preview_frame_class = \"icon quote\"; }\n\t\tif (is_post_link) { m_post_type_text = \"link\"; preview_frame_class = \"icon link\"; }\n\t\tif (is_post_audio) { m_post_type_text = \"audio post\"; preview_frame_class = \"icon audio\"; }\n\t\tif (is_post_video) { m_post_type_text = \"video post\"; preview_frame_class = \"icon video\"; }\n\t\tif (is_mention) { m_post_type_text = \"in a post\"; preview_frame_class = \"icon mention\"; }\n\n\t\tvar load_url = \"\";\n\n\t\tvar additional_classes = \"\";\n\n\t\tif (XKit.extensions.old_notifications.notification_count === 0)\n\t\t\tadditional_classes = additional_classes + \" first_notification \";\n\n\t\tif (XKit.extensions.old_notifications.notification_count % 2 === 0)\n\t\t\tadditional_classes = additional_classes + \" alt \";\n\n\t\tif (response !== \"\")\n\t\t\tadditional_classes = additional_classes + \" with_commentary \";\n\n\t\tif (is_answer)\n\t\t\tadditional_classes = additional_classes + \" notification_answer \";\n\n\t\tif (is_reply)\n\t\t\tadditional_classes = additional_classes + \" notification_reply \";\n\n\t\tif (is_reblog)\n\t\t\tadditional_classes = additional_classes + \" notification_reblog \";\n\n\t\tif (is_like)\n\t\t\tadditional_classes = additional_classes + \" notification_like\";\n\n\t\tif (is_follow)\n\t\t\tadditional_classes = additional_classes + \" notification_follower\";\n\n\t\tif (is_mention)\n\t\t\tadditional_classes = additional_classes + \" notification_user_mention\";\n\n\t\tif (is_friend)\n\t\t\tadditional_classes = additional_classes + \" xkit_notification_follower_is_friend\";\n\n\t\tvar m_inner_html = \"\";\n\t\tvar no_preview_frame = false;\n\n\t\tif ($obj.hasClass('fanmail')) {\n\t\t\tload_url = notification_url;\n\t\t\tm_inner_html = $obj.find(\".activity\").html();\n\t\t}\n\n\t\tif (is_follow) {\n\n\t\t\tload_url = notification_user_url;\n\n\t\t\tm_inner_html = \"<a class=\\\"username\\\" href=\\\"\" + notification_user_url + \"\\\">\" + notification_username + \"</a> started following you \";\n\t\t\tno_preview_frame = true;\n\n\t\t}\n\n\t\tif (is_like) {\n\n\t\t\tload_url = notification_url;\n\n\t\t\tm_inner_html = \"<a class=\\\"username\\\" href=\\\"\" + notification_user_url + \"\\\">\" + notification_username + \"</a> liked your \";\n\n\t\t\tif (summary !== \"\") {\n\t\t\t\tm_inner_html = m_inner_html + m_post_type_text + \"<span class=\\\"colon\\\">:</span> <em style=\\\"white-space:nowrap;\\\"><a class=\\\"notification_target\\\" href=\\\"\" + notification_url + \"\\\">\" + summary + \"</em></a>\";\n\t\t\t} else {\n\t\t\t\tm_inner_html = m_inner_html + \"<a class=\\\"notification_target\\\" href=\\\"\" + notification_url + \"\\\">\" + m_post_type_text + \"</a>\";\n\t\t\t}\n\t\t}\n\n\t\tif (is_reblog) {\n\n\t\t\tload_url = notification_url;\n\n\t\t\tm_inner_html = \"<a class=\\\"username\\\" href=\\\"\" + notification_user_url + \"\\\">\" + notification_username + \"</a> reblogged your \";\n\n\t\t\tif (summary !== \"\") {\n\t\t\t\tm_inner_html = m_inner_html + m_post_type_text + \"<span class=\\\"colon\\\">:</span> <em style=\\\"white-space:nowrap;\\\"><a class=\\\"notification_target\\\" href=\\\"\" + notification_url + \"\\\">\" + summary + \"</em></a>\";\n\t\t\t} else {\n\t\t\t\tm_inner_html = m_inner_html + \"<a class=\\\"notification_target\\\" href=\\\"\" + notification_url + \"\\\">\" + m_post_type_text + \"</a>\";\n\t\t\t}\n\n\t\t\tif (response !== \"\") {\n\t\t\t\tm_inner_html = m_inner_html + \"<span class=\\\"colon\\\">:</span>\" + response;\n\t\t\t}\n\n\t\t}\n\n\t\tif (is_mention) {\n\n\t\t\tload_url = notification_url;\n\n\t\t\tm_inner_html = \"<a class=\\\"username\\\" href=\\\"\" + notification_user_url + \"\\\">\" + notification_username + \"</a> mentioned you \";\n\n\t\t\tif (summary !== \"\") {\n\t\t\t\tm_inner_html = m_inner_html + m_post_type_text + \"<span class=\\\"colon\\\">:</span> <em style=\\\"white-space:nowrap;\\\"><a class=\\\"notification_target\\\" href=\\\"\" + notification_url + \"\\\">\" + summary + \"</em></a>\";\n\t\t\t} else {\n\t\t\t\tm_inner_html = m_inner_html + \"<a class=\\\"notification_target\\\" href=\\\"\" + notification_url + \"\\\">\" + m_post_type_text + \"</a>\";\n\t\t\t}\n\n\t\t\tif (response !== \"\") {\n\t\t\t\tm_inner_html = m_inner_html + \"<span class=\\\"colon\\\">:</span>\" + response;\n\t\t\t}\n\n\t\t}\n\n\n\t\tif (is_reply) {\n\n\t\t\tload_url = notification_url;\n\n\t\t\tm_inner_html = \"<a class=\\\"username\\\" href=\\\"\" + notification_user_url + \"\\\">\" + notification_username + \"</a> replied to your \";\n\n\t\t\tif (summary !== \"\") {\n\t\t\t\tm_inner_html = m_inner_html + m_post_type_text + \"<span class=\\\"colon\\\">:</span> <em style=\\\"white-space:nowrap;\\\"><a class=\\\"notification_target\\\" href=\\\"\" + notification_url + \"\\\">\" + summary + \"</em></a>\";\n\t\t\t} else {\n\t\t\t\tm_inner_html = m_inner_html + \"<a class=\\\"notification_target\\\" href=\\\"\" + notification_url + \"\\\">\" + m_post_type_text + \"</a>\";\n\t\t\t}\n\n\t\t\tif (response !== \"\") {\n\t\t\t\tm_inner_html = m_inner_html + \"<span class=\\\"colon\\\">:</span>\" + response;\n\t\t\t}\n\n\t\t}\n\n\t\tif (is_answer) {\n\n\t\t\tload_url = notification_url;\n\n\t\t\tm_inner_html = \"<a class=\\\"username\\\" href=\\\"\" + notification_user_url + \"\\\">\" + notification_username + \"</a> answered your \";\n\n\t\t\tif (summary !== \"\") {\n\t\t\t\tm_inner_html = m_inner_html + m_post_type_text + \"<span class=\\\"colon\\\">:</span> <em style=\\\"white-space:nowrap;\\\"><a class=\\\"notification_target\\\" href=\\\"\" + notification_url + \"\\\">\" + summary + \"</em></a>\";\n\t\t\t} else {\n\t\t\t\tm_inner_html = m_inner_html + \"<a class=\\\"notification_target\\\" href=\\\"\" + notification_url + \"\\\">\" + m_post_type_text + \"</a>\";\n\t\t\t}\n\n\t\t\tif (response !== \"\") {\n\t\t\t\tm_inner_html = m_inner_html + \"<span class=\\\"colon\\\">:</span>\" + response;\n\t\t\t}\n\n\t\t}\n\n\t\tvar preview_img_html = \"\";\n\n\t\tif (is_post_photo) {\n\t\t\tpreview_img_html = \"<img src=\\\"\" + preview_image + \"\\\">\";\n\t\t}\n\n\t\tvar m_html = \"<li data-url-original=\\\"\" + fake_original_url + \"\\\" data-load-url=\\\"\" + load_url + \"\\\" id=\\\"xkit-old-notifications-\" + (XKit.extensions.old_notifications.notification_count + 1) + \"\\\" class=\\\"xkit-old-notifications notification \" + additional_classes + \"\\\">\" +\n\t\t\t\t\"<div class=\\\"notification_inner  clearfix\\\">\" +\n\t\t\t\t\t\"<div class=\\\"notification_sentence\\\">\" +\n\t\t\t\t\t\t\"<div class=\\\"hide_overflow\\\">\" +\n\t\t\t\t\t\t\tm_inner_html +\n\t\t\t\t\t\t\"</div>\" +\n\t\t\t\t\t\"</div>\" +\n\t\t\t\t\"</div>\" +\n\t\t\t\t\"<a target=\\\"_blank\\\" href=\\\"\" + notification_user_url + \"\\\" class=\\\"avatar_frame\\\">\" +\n\t\t\t\t\t\"<img alt=\\\"\\\" class=\\\"avatar\\\" src=\\\"\" + notification_avatar + \"\\\" data-src=\\\"\" + notification_avatar + \"\\\">\" +\n\t\t\t\t\"</a>\";\n\n\t\tif (!no_preview_frame) {\n\t\t\tm_html = m_html + \"<div class=\\\"notification_right\\\">\" +\n\t\t\t\t\t\"<a target=\\\"_blank\\\" class=\\\"preview_frame \" + preview_frame_class + \"\\\" href=\\\"\" + notification_url + \"\\\">\" + preview_img_html + \"</a>\" +\n\t\t\t\t\"</div>\";\n\t\t}\n\t\tm_html = m_html + \"</li>\";\n\n\t\tXKit.extensions.old_notifications.notification_count++;\n\n\t\treturn m_html;\n\n\t},\n\n\trender_notification_old: function(obj) {\n\n\t\tvar new_obj = $(obj);\n\n\t\tif ($(new_obj).find(\".ui_note\").length <= 0) { return \"\"; }\n\n\t\t$(new_obj).find(\".date_header\").remove();\n\t\t$(new_obj).find(\".part_glass\").remove();\n\t\t$(new_obj).find(\".part_ignore\").remove();\n\t\t$(new_obj).find(\".note_follow\").remove();\n\n\t\t$(new_obj).find(\".ui_avatar\").unwrap();\n\n\t\t$(new_obj).find(\".ui_avatar\").addClass(\"avatar_frame_temporary\");\n\t\t$(new_obj).find(\".ui_avatar\").removeClass(\"ui_avatar\");\n\n\t\t$(new_obj).find(\".ui_note\").addClass(\"notification\");\n\t\t$(new_obj).find(\".ui_note\").removeClass(\"ui_note\");\n\n\t\t$(new_obj).find(\".stage\").addClass(\"notification_inner clearfix\");\n\t\t$(new_obj).find(\".stage\").removeClass(\"stage\");\n\n\t\t$(new_obj).find(\".part_icon\").addClass(\"notification_right\");\n\t\t$(new_obj).find(\".part_icon\").removeClass(\"part_icon\");\n\n\t\t$(new_obj).find(\".part_activity\").addClass(\"notification_sentence\");\n\t\t$(new_obj).find(\".part_activity\").removeClass(\"part_activity\");\n\n\t\t$(new_obj).find(\".ui_post_badge\").addClass(\"preview_frame\");\n\t\t$(new_obj).find(\".ui_post_badge\").removeClass(\"ui_post_badge\");\n\n\t\t$(new_obj).find(\".part_main\").addClass(\"hide_overflow\");\n\t\t$(new_obj).find(\".part_main\").removeClass(\"part_main\");\n\n\t\tif ($(new_obj).find(\".preview_frame\").hasClass(\"photo\")) {\n\t\t\tvar m_src = $(new_obj).find(\".preview_frame\").css(\"background-image\");\n\t\t\t// ugly but works:\n\t\t\tm_src = m_src.substring(4, m_src.length - 1);\n\t\t\t$(new_obj).find(\".preview_frame\").append(\"<img src=\\\"\" + m_src + \"\\\">\");\n\t\t} else {\n\t\t\t$(new_obj).find(\".preview_frame\").addClass(\"icon\");\n\t\t}\n\n\t\t$(new_obj).find(\".activity\").find(\"a:first-child\").addClass(\"username\");\n\n\t\tif ($(new_obj).find(\".summary\").length > 0) {\n\t\t\t$(new_obj).find(\".activity\").after(\"<span class=\\\"colon\\\">:</span>\");\n\t\t}\n\n\t\t// Get avatar:\n\t\t$(new_obj).find(\".avatar\").addClass(\"old-avatar-div\");\n\t\tvar avatar_url = $(new_obj).find(\".avatar\").css(\"background-image\");\n\t\tavatar_url = avatar_url.substring(4, avatar_url.length - 1);\n\t\t$(new_obj).find(\".notification\").append(\"<a class=\\\"avatar_frame\\\"> <img class=\\\"avatar\\\" src=\\\"\" + avatar_url + \"\\\" data-src=\\\"\" + avatar_url + \"\\\"></a>\");\n\n\t\t$(new_obj).find(\".avatar_frame_temporary\").remove();\n\n\t\tif ($(new_obj).find(\".part_response\").length > 0) {\n\t\t\tvar m_response = $(new_obj).find(\".part_response\").html();\n\t\t\t$(new_obj).find(\".notification_sentence\").find(\".hide_overflow\").after(m_response);\n\t\t\t$(new_obj).find(\".part_response\").remove();\n\t\t}\n\t\t// first_notification -- last_notification\n\t\tvar additional_classes = \"\";\n\n\t\tvar m_link = $(obj).find(\".part_glass\").attr('href');\n\n\t\tif ($(new_obj).find(\".notification\").hasClass(\"is_answer\"))\n\t\t\tadditional_classes = additional_classes + \" notification_answer \";\n\n\t\tif ($(new_obj).find(\".notification\").hasClass(\"is_reply\"))\n\t\t\tadditional_classes = additional_classes + \" notification_reply \";\n\n\t\tif ($(new_obj).find(\".notification\").hasClass(\"is_reblog\"))\n\t\t\tadditional_classes = additional_classes + \" notification_reblog \";\n\n\t\tif ($(new_obj).find(\".notification\").hasClass(\"is_like\"))\n\t\t\tadditional_classes = additional_classes + \" notification_like\";\n\n\t\tif (XKit.extensions.old_notifications.alt_notification)\n\t\t\tadditional_classes = additional_classes + \" alt \";\n\n\t\tif (XKit.extensions.old_notifications.notification_count === 0)\n\t\t\tadditional_classes = additional_classes + \" first_notification \";\n\n\t\tif (XKit.extensions.old_notifications.notification_count === XKit.extensions.old_notifications.max_notifications - 1)\n\t\t\tadditional_classes = additional_classes + \" last_notification \";\n\n\t\tvar m_html = \"<li data-url=\\\"\" + m_link + \"\\\" class=\\\"notification by-xkit-old-notifications \" + additional_classes + \"\\\">\" + $(new_obj).html() + \"</li>\";\n\n\t\tXKit.extensions.old_notifications.alt_notification = !XKit.extensions.old_notifications.alt_notification;\n\n\t\tXKit.extensions.old_notifications.notification_count++;\n\t\treturn m_html;\n\n\t},\n\n\tfetch_successful: function(data) {\n\n\t\tif (XKit.installed.check(\"notificationblock\") === true) {\n\t\t\tconsole.log(\"notificationblock installed.\");\n\t\t\tif (typeof XKit.extensions.notificationblock !== \"undefined\") {\n\t\t\t\tif (XKit.extensions.notificationblock.running === true) {\n\t\t\t\t\tif (XKit.extensions.notificationblock.blacklisted !== \"undefined\") {\n\t\t\t\t\t\tXKit.extensions.old_notifications.blacklisted = XKit.extensions.notificationblock.blacklisted;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.log(\"notificationblock blacklist is undefined.\");\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log(\"notificationblock is not running.\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconsole.log(\"notificationblock is undefined.\");\n\t\t\t}\n\t\t}\n\n\t\tvar m_html = \"\";\n\t\t$(\".activity-notification\", data).each(function() {\n\t\t\tif (XKit.extensions.old_notifications.notification_count >= XKit.extensions.old_notifications.max_notifications) { return false; }\n\t\t\tm_html = m_html + XKit.extensions.old_notifications.render_notification($(this)[0].outerHTML);\n\t\t});\n\t\t$(\".new_post_buttons_container\").after(m_html);\n\t\t$(\"#xkit-old-notifications-\" + XKit.extensions.old_notifications.notification_count).addClass(\"last_notification\");\n\n\t\tif (XKit.installed.check(\"notificationblock\") === true) {\n\t\t\tif (typeof XKit.extensions.notificationblock !== \"undefined\") {\n\t\t\t\tif (XKit.extensions.notificationblock.running === true) {\n\t\t\t\t\tconsole.log(\"Found NotificationBlock, calling.\");\n\t\t\t\t\tXKit.extensions.notificationblock.do();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Lets see if there is sth we should be doing to these notifications.\n\t\tsetTimeout(function() { XKit.post_listener.check(true); }, 400);\n\n\t},\n\n\tfetch_id: \"\",\n\n\tfetch: function() {\n\n\t\tvar my_id = XKit.tools.random_string();\n\t\tXKit.extensions.old_notifications.fetch_id = my_id;\n\n\t\tsetTimeout(function() {\n\t\t\tvar to_fetch = document.location.href.replace(\"/blog/\", \"/activity/\");\n\t\t\tconsole.log(\"Trying to fetch \" + to_fetch);\n\t\t\tGM_xmlhttpRequest({\n\t\t\t\tmethod: \"GET\",\n\t\t\t\turl: to_fetch,\n\t\t\t\tonerror: function(response) {\n\t\t\t\t\tif (my_id !== XKit.extensions.old_notifications.fetch_id) { return; }\n\t\t\t\t\tXKit.extensions.old_notifications.fetch_failed();\n\t\t\t\t},\n\t\t\t\tonload: function(response) {\n\t\t\t\t\tif (my_id !== XKit.extensions.old_notifications.fetch_id) { return; }\n\t\t\t\t\tXKit.extensions.old_notifications.fetch_successful(response.responseText);\n\t\t\t\t}\n\t\t\t});\n\t\t}, 300);\n\n\t},\n\n\tdestroy: function() {\n\t\tthis.running = false;\n\t\tthis.notification_count = 0;\n\t\tthis.alt_notification = false;\n\t\tthis.blacklisted = [];\n\t\tXKit.extensions.old_notifications.fetch_id = \"-1\";\n\t\t$(\".xkit-old-notifications\").remove();\n\t}\n\n});\n","file":"found","server":"up","errors":false,"icon":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC+aJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpGNzdGMTE3NDA3MjA2ODExODA4MzkyMjM2MzU5MTQ4NCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3M0QxM0REMTgwNjUxMUUzQjQwNzg0MDQ5NEU0RjJCNCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3M0QxM0REMDgwNjUxMUUzQjQwNzg0MDQ5NEU0RjJCNCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjAxODAxMTc0MDcyMDY4MTFBRTczREVDNEM5OEM0RTE5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkY3N0YxMTc0MDcyMDY4MTE4MDgzOTIyMzYzNTkxNDg0Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+dQXcagAABfpJREFUeNrsWmtsFFUUvq9d2t2UFspS2FKgICBbKVg1BolCpCrGxBgipok/FBKJCCYG4w9JIIHIQ4ioxBIkMQgq2lqFJkYRRbABo2jRYuXd1tLdta+lXWj3OfdeZ5G2+5id2d25Q9LYyaRNZu7M/c453znnu3cW+mvAsD4IgMPbAATAiAEjBozkwIgBIxTSY0Dqhxlg29PQMmPwAu36gvdeEkAD2yJIcpmnlofSfhb6D6UE3VTyAZ6yIvEO9/0d/n056zqRuQuLXySO7cCUwzqPhevLeTDdHJAppHrCMY6s8h5F9BEHWKaaFxwnM9dpvkfxxJOeJXPekdFHoIxfjO2r0n2DRhJDCxg1/xQw52l40bEZ259JnzmLSekugEYNXZJ8gquQad7xaPS894/wbxWBWhj8HtPWfTEj576fHndzZ5rKDkDz2KGX+53Usz99A1SiY3tETq9o9MG6u6m7Sr7FfSzcsEI6tz4qT/JwYUWKcYfZwFz2JcyyR0NhrmoeSJuESOUuHv949ASh+kVxA+iVN0CoN4pvM1KaVC4JZSfg6JIYT0r9UltlBnmk1gfQuIej3N8AfN7EwcFvx8QyQyvkGJjmVKNxC+Mus87vQF9zBk1JzQCYN3doAs+PQloemb0XFS5LKMaMOvdn9v5UpQQP9+pHj6etw8UvJF5nPfXMc9hoKQF1RgDbV5LZGxVvMdcngIHM3q9mAPddhZbJg92eNivBKloLTANpEO6hbTuV0Y9bSu7aDqCCcuH+f1jHroy9o6aFuPfskAH5DwKTDDHh+Ts3AFPuLWnUXJmk5C/Ec94bHBbvfncND3Edcjp5ieKeuhis0yvjBpDpm2Ng+VqVSv5UU+lemD1ReX7aT90fZyZDBqRE8nuScwf3X41KwZfIrN3AbL0lYyauxNNWD0EJe6WO3fEvMVtJ6WcwZ2Yy/7HOH3j/aT0GaMhpenELmbcnyoZV8sk8p2RqweyimJEte0C4P77kOw6i/PuTc5Qy9+c6KxsMHNHKkkmv45ItGnY6q6S/KhJK/od48nMqT7GeM+H6ewDVuaTUipHk2io1vMz9bUnRX94hnYtXQaR4mzp6uXmxtgO3qqeOEwaOplzIC9ag0XNBzoCGkbz8eiNtr+GBX+JHTlh7s2hiNfxBD218BdBk+hmyYAsPnEmBQkeB2APnPx9R+SRHs7mrty7ud9GLm2jXXr0USq+o5T6FHdtSQK+t+2B2ISpakUIVglZRvofmUlLyFswqEBbNUKcmPNmAUYL2N6aQkl3QOk0UeOZtlJp3asIjUF4dCdgYySWztqKx94pCz29clhrXgNAVTXhyIzPppw6Zvh4VPCYMfV9z+M/VINSaCjaiqBDTcj4uWoMmVQhD73dJ514DoZYUgZHIElUP/LyHcPFKYegDbun8Ou6/kDoq2QCd65ScmI0dPeiDHfT8Bt5XnxYkvRFg3p+ZuxZNWKJmBueamHiwm57fxPrOpIsHBuvKBBQhiyN580L4jlehtVgNfegavbCReU9mtiITQADma0q+f7hkcFmnjF66Ti+/yby/ZoZEdw6oR8Zkw1OWq6k6qZ9e2sF6TmYMQ28OaBB04rK4dU+sEA/Sprdvos8cAzHuKxPKKkQTnlChDm16l3Yf1wlAfyNLbkDhMphsX54z2lRJu4/pn92oHEDWGci2OOlauGUP7fpGyNRGRSCy1Y4tysxv3Uc7vxY1r6xGsXj3594Hx85XRn/1I9ZeK3BSAyKAspB9KYBIafOimrUfFjsjgUBwBOCYB+Boh0Kza/+Ku2uET0eAWAphC7I/qYC+4whzVQED6CrYAGQrT+xcrOsYc1bdlHSGGCCukZltUJalcei765jzU5n/IicyKAKo4FFoivlkxjw/MedBue4b4XvRUiLLHvmGEN2urp2OoGdhQ38TI6yMQmyN7ly8t4H+h94wqSI4B3jAxTynUP6CyK5tTz1zVwMWNIj3RjUy5j7Eb1yQ/0f+spDRvjegCvEwv352gFK36bdgBAAMhvNBbpurhkEOjETg/2kAHOYU+leAAQANAvtA2b1P/gAAAABJRU5ErkJggg==","title":"Classic Notifications","description":"Notifications where they were","developer":"New-XKit","version":"0.7.3","details":"This is a very experimental extension that brings back the notifications to your blog pages (ie: www.tumblr.com/blog/new-xkit-extension), just the way it was before Tumblr's Activity update.","frame":"false","beta":"false","slow":"false"}